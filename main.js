KEYS={BACKSPACE:8,SHIFT:16,SPACE:32,KEY_0:48,KEY_Z:90,COMMA:188,DASH:189,PERIOD:190,FORWARD_SLASH:191,GRAVE_ACCENT:192};let right_shift_letters="qazwsxedcrfvtgb";var start_time,results_set=!1,word_count=0,mistakes=0,left_upper=!1,right_upper=!1,completed,cursor,uncompleted;let requestText=async()=>{let e=await fetch('https://www.randomtext.me/api/gibberish/h1/50'),n=await e.json();text=n.text_out.replace("<h1>","").replace("<h1/>","").replace(/\b\w/g,e=>e.toUpperCase()).replace(/\s+/g,' ').trim();setText(text)};function setText(e){completed.innerHTML="";cursor.innerHTML=e.charAt(0);uncompleted.innerHTML=e.substring(1);word_count=e.split(" ").length}document.addEventListener("DOMContentLoaded",function(e){completed=document.getElementById("tutor-completed");cursor=document.getElementById("tutor-cursor");uncompleted=document.getElementById("tutor-uncompleted");requestText()});document.addEventListener('keyup',function(e){e.location===KeyboardEvent.DOM_KEY_LOCATION_LEFT?(left_upper=!1):e.location===KeyboardEvent.DOM_KEY_LOCATION_RIGHT&&(right_upper=!1)});document.addEventListener('keydown',function(e){start_time||(start_time=new Date.getTime());var n='';switch(e.keyCode){case KEYS.SPACE:e.preventDefault();n=' ';break;case KEYS.FORWARD_SLASH:e.preventDefault();n='/';break;case KEYS.COMMA:n=',';break;case KEYS.PERIOD:n='.';break;case 173:n='-';break;case KEYS.SHIFT:if(e.location===KeyboardEvent.DOM_KEY_LOCATION_LEFT){left_upper=!0;return}else if(e.location===KeyboardEvent.DOM_KEY_LOCATION_RIGHT){right_upper=!0;return};case KEYS.BACKSPACE:uncompleted.innerHTML=cursor.innerHTML+uncompleted.innerHTML;cursor.innerHTML=completed.innerHTML.slice(-1);completed.innerHTML=completed.innerHTML.slice(0,-1);console.log("BACKSPACED");break;default:if(KEYS.KEY_0<=e.keyCode&&e.keyCode<=KEYS.KEY_Z){n=String.fromCharCode(e.keyCode);n=n.toLowerCase();right_upper&&right_shift_letters.includes(n)?(n=n.toUpperCase()):left_upper&&!right_shift_letters.includes(n)&&(n=n.toUpperCase());break}}n==cursor.innerHTML?(completed.innerHTML+=n,cursor.innerHTML=(uncompleted.innerHTML.charAt(0)),uncompleted.innerHTML=uncompleted.innerHTML.substr(1)):mistakes++;if(uncompleted.innerHTML.length==0&&cursor.innerHTML.length==0&&!results_set){var t=new Date.getTime(),r=document.getElementById("result"),i=word_count/((t-start_time)/1e3/60),o=mistakes/word_count;r.innerHTML=`WPM:${i.toFixed(2)}; MPW:${o.toFixed(2)}; Words:${word_count}; Mistakes:${mistakes};`;results_set=!0}})
